Write-Output 'Disable Lockscreen'
If (-Not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\Personalization"))
{
    New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows" -Name "Personalization"
}
New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\Personalization" -Name "NoLockScreen" -Value 1 -PropertyType Dword
Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\Personalization" -Name "NoLockScreen" -Value 1

Write-Output 'Disabling Screensaver'
Set-ItemProperty 'HKCU:\Control Panel\Desktop' -Name 'ScreenSaveActive' -Value 0 -Type DWord
powercfg -x -monitor-timeout-ac 0
powercfg -x -monitor-timeout-dc 0

Write-Output "Disable New Network Prompt"
cmd.exe /c reg add "HKLM\System\CurrentControlSet\Control\Network\NewNetworkWindowOff"

Write-Host 'Set high performance power profile'
powercfg -setactive '8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c'

Write-Host 'Turn off Hibernation'
powercfg.exe /hibernate off

Write-Host 'Turn off monitor timeout on AC power'
powercfg -Change -monitor-timeout-ac 0

Write-Host 'Turn off monitor timeout on DC power'
powercfg -Change -monitor-timeout-dc 0

Write-Host 'Zero Hibernation File'
Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Power' -Name HiberFileSizePercent -Type DWORD -Value 0

Write-Host 'Disable Hibernation Mode'
Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Power' -Name HibernateEnabled -Type DWORD -Value 0